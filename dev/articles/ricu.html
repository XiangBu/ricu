<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>\pkg{ricu}: \proglang{R}'s interface for ICU data,ricu: R's interface for ICU data,\pkg{ricu}: R meets ICU data • ICU data with R</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="\pkg{ricu}: \proglang{R}'s interface for ICU data,ricu: R's interface for ICU data,\pkg{ricu}: R meets ICU data">
<meta property="og:description" content="ricu">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ICU data with R</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ricu.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/demo.html">demo</a>
    </li>
    <li>
      <a href="../articles/uom.html">Units of measurement</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/septic-tank/ricu">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>true</h1>
                        <h4 class="author">Benito</h4>
            <address class="author_afil">
      ETH Zürich<br><h4 class="author">Drago</h4>
            <address class="author_afil">
      ETH Zürich<br><h4 class="author">Ida</h4>
            <address class="author_afil">
      Papworth<br><div class="hidden name"><code>ricu.Rmd</code></div>

    </address>
</address>
</address>
</div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>The abstract of the article.</p>
    </div>
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Collection of health records has seen a significant rise in the recent years . This has opened an opportunity for a large body of data-driven research oriented towards improving patient care and outcomes, together with helping clinicians in decision-making .</p>
<p>For instance, an example of a problem that has received much attention from the machine learning community is early prediction of sepsis in ICU . Interestingly, there is evidence that a large proportion of the publications are based on the same dataset , the Medical Information Mart for Intensive Care (MIMIC) , which shows a systematic lack of external validation. Part of this problem might well be the lack of a computational infrastructure handling multiple datasets. The MIMIC-III dataset consists of 26 different tables containing about 20GB of data. Handling data of this form can require considerable technical profficiency and knowledge of different programming languages. Co-integrating multiple different datasets of this form is, naturally, even more demanding.</p>
<p>The aim of the  package is to provide the computational infrastructure which allows users to access complex research questions as easily as possible. The package also aims to enable users to write dataset-agnostic code which can simplify implementation and shorten the necessary time for prototyping code to different datasets. In particular, the package handles three large, publicly available intensive care databases: the already mentioned MIMIC-III database from the Beth Israel Deaconess Medical Center in Boston, Massachusetts, the eICU Collaborative Research Database , containing data collected from 208 hospitals across the United States, and the HiRID database  from the Department of Intensive Care Medicine of the Bern University Hospital, Switzerland. Together with this, much of the functionality used is also aimed to accommodate for addition of possible additional datasets, provided by the user. The work most similar to ours is that of  and . However, these works address only the MIMIC-III dataset and do not have an emphasis on dataset inter-operability.</p>
<p>The structure of the manuscript is as follows. In Section  we outline the different types of data useful for research related to intensive care medicine. We explain the most important parts of the package functionality which are used to handle the different data types. In Section  we provide simple examples which illustrate how some simple research questions can be explored in only a couple of lines of code.</p>
</div>
<div id="implementation" class="section level1">
<h1 class="hasAnchor">
<a href="#implementation" class="anchor"></a>Implementation</h1>
<p>In this Section we go over the categories of data useful for research problems related to intensive care medicine. The categories we define are fairly broad and somewhat loosely defined, as this is not the main focus of the manuscript.</p>
<div id="physiological-data" class="section level2">
<h2 class="hasAnchor">
<a href="#physiological-data" class="anchor"></a>Physiological data</h2>
<p>Labs, vitals. Could introduce the  here.</p>
</div>
<div id="treatment-related-information" class="section level2">
<h2 class="hasAnchor">
<a href="#treatment-related-information" class="anchor"></a>Treatment-related information</h2>
<p>Antibiotics, vasopressors, mechanical ventilation… could introduce the  here.</p>
</div>
<div id="co-morbidities" class="section level2">
<h2 class="hasAnchor">
<a href="#co-morbidities" class="anchor"></a>Co-morbidities</h2>
<p>Based on ICD-9 codes. Should enable the extraction of co-morbidities used for the Charlson and Elixhauser scores.</p>
</div>
<div id="admission-diagnoses" class="section level2">
<h2 class="hasAnchor">
<a href="#admission-diagnoses" class="anchor"></a>Admission diagnoses</h2>
<p>Categorizing into surgical, non-surgical and other might be sufficient for now.</p>
</div>
<div id="patient-information" class="section level2">
<h2 class="hasAnchor">
<a href="#patient-information" class="anchor"></a>Patient information</h2>
<p>Age, gender, other demograpichs, patient stay information.</p>
</div>
<div id="outcomes" class="section level2">
<h2 class="hasAnchor">
<a href="#outcomes" class="anchor"></a>Outcomes</h2>
<p>Death outcome, prolonged ICU stay outcome.</p>
</div>
</div>
<div id="examples" class="section level1">
<h1 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h1>
<p>We focus on two simple examples with which we try to cover most of the data types described in Section .</p>
<div id="lactate-and-mortality" class="section level2">
<h2 class="hasAnchor">
<a href="#lactate-and-mortality" class="anchor"></a>Lactate and mortality</h2>
<p>The first example we look at is the association of lactate levels and mortality. This problem has been studied before and it is widely accepted that both static and dynamic lactate indices are associated with increased mortality . We quickly look at how one might fit a time-varying proportional hazards Cox model  in order to investigate this problem. We additionally include the Sequential Organ Failure Assessment (SOFA) score  as a general predictor of illness severity.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="no">source</span> <span class="kw">&lt;-</span> <span class="st">"mimic_demo"</span>
<span class="co"># data loading</span>
<span class="no">tbl</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/ts_utils.html">fill_gaps</a></span>(<span class="fu"><a href="../reference/load_concepts.html">load_concepts</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"lactate"</span>, <span class="st">"death"</span>), <span class="no">source</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="no">F</span>))
<span class="no">tbl</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span>(<span class="no">tbl</span>, <span class="fu"><a href="../reference/label_sofa.html">sofa</a></span>(<span class="no">source</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="no">F</span>), <span class="kw">all</span> <span class="kw">=</span> <span class="no">T</span>)
<span class="no">tbl</span> <span class="kw">&lt;-</span> <span class="no">tbl</span>[, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="../reference/meta_utils.html">meta_cols</a></span>(<span class="no">tbl</span>), <span class="st">"lactate"</span>, <span class="st">"sofa_score"</span>, <span class="st">"death"</span>), <span class="kw">with</span> <span class="kw">=</span> <span class="no">F</span>]
<span class="no">tbl</span> <span class="kw">&lt;-</span> <span class="no">tbl</span>[, <span class="no">lactate</span> <span class="kw">:=</span> <span class="fu">nafill</span>(<span class="no">lactate</span>, <span class="st">"locf"</span>)]
<span class="no">tbl</span> <span class="kw">&lt;-</span> <span class="no">tbl</span>[, <span class="no">lactate</span> <span class="kw">:=</span> <span class="fu">nafill</span>(<span class="no">lactate</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="fl">1</span>)]
<span class="no">tbl</span>[, <span class="no">event</span> <span class="kw">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">death</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="no">T</span>) <span class="kw">&gt;</span> <span class="fl">0</span>), <span class="kw">by</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span>(<span class="fu"><a href="../reference/meta_utils.html">id</a></span>(<span class="no">tbl</span>))]
<span class="no">tbl</span>[, <span class="no">event</span> <span class="kw">:=</span> <span class="fu">last_event</span>(<span class="no">event</span>), <span class="kw">by</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span>(<span class="fu"><a href="../reference/meta_utils.html">id</a></span>(<span class="no">tbl</span>))]
<span class="no">tbl</span>[, <span class="no">next_charttime</span> <span class="kw">:=</span> <span class="no">charttime</span>+<span class="fl">1L</span>]
<span class="co"># model fitting</span>
<span class="no">cox_time_mod</span> <span class="kw">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(<span class="no">charttime</span>, <span class="no">next_charttime</span>, <span class="no">event</span>) ~ <span class="no">lactate</span> + <span class="no">sofa_score</span>,
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">tbl</span>)</pre></body></html></div>
<p>We visualize the results of the model <img src="ricu_files/figure-html/cox_plot-1.png" width="700"> A simple exploration already shows that the increased values of lactate are associated with mortality, even after adjusting for the SOFA score.</p>
</div>
<div id="diabetes-and-insulin-treatment" class="section level2">
<h2 class="hasAnchor">
<a href="#diabetes-and-insulin-treatment" class="anchor"></a>Diabetes and insulin treatment</h2>
<p>The next example we turn to covers the usage of co-morbidities and treatment related information. We look at the amount of insulin administered to patients in the first 24 hours from their ICU admission. In particular, we investigate if patients who are diabetic receive more insulin in the first day of their stay. We extract the data as follows:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">source</span> <span class="kw">&lt;-</span> <span class="st">"mimic_demo"</span>
<span class="no">ins_breaks</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.01</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">40</span>)

<span class="no">cohort</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/stay_windows.html">stay_windows</a></span>(<span class="no">source</span>)
<span class="no">ins_treat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/load_concepts.html">load_concepts</a></span>(<span class="st">"insulin"</span>, <span class="no">source</span>)
<span class="no">ins_treat</span> <span class="kw">&lt;-</span> <span class="no">ins_treat</span>[<span class="fu"><a href="https://rdrr.io/r/base/get.html">get</a></span>(<span class="fu"><a href="../reference/meta_utils.html">index</a></span>(<span class="no">ins_treat</span>)) <span class="kw">&lt;=</span> <span class="fl">24L</span>]
<span class="no">ins_treat</span> <span class="kw">&lt;-</span> <span class="no">ins_treat</span>[, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">ins_sum</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bincode.html">.bincode</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">insulin</span>), <span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">Inf</span>, <span class="no">ins_breaks</span>, <span class="fl">Inf</span>))-<span class="fl">1</span>),
  <span class="kw">by</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span>(<span class="fu"><a href="../reference/meta_utils.html">id</a></span>(<span class="no">ins_treat</span>))]

<span class="no">cohort</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span>(<span class="no">cohort</span>, <span class="no">ins_treat</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="fu"><a href="../reference/meta_utils.html">id</a></span>(<span class="no">cohort</span>), <span class="kw">all.x</span> <span class="kw">=</span> <span class="no">T</span>)
<span class="no">cohort</span>[, <span class="no">Diabetic</span> <span class="kw">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html">get</a></span>(<span class="fu"><a href="../reference/meta_utils.html">id</a></span>(<span class="no">cohort</span>)) <span class="kw">%in%</span> <span class="fu">diabetes</span>(<span class="no">source</span>)]
<span class="no">cohort</span>[<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">ins_sum</span>), <span class="st">"ins_sum"</span>] <span class="kw">&lt;-</span> <span class="fl">0</span></pre></body></html></div>
<p>After this, we can visualize the difference between the two groups with a histogram: <img src="ricu_files/figure-html/diabetes_visualize-1.png" width="700"> The plot might suggest that diabetic patients do receive more insulin that non-diabetic patients, in the first day of ICU stay.</p>

</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Drago Plecko, Nicolas Bennett.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
